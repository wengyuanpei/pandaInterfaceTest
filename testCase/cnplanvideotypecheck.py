# coding:utf-8
import requests
from common.finish_plan_urlenverment import *
from common.get_tlj_auth import *
from time import sleep
basurl=urlenverment(2)
authdev='Bearer eyJhbGciOiJIUzUxMiJ9.eyJqdGkiOiIxNjgxMTA3NjgwMTg0MzQwNDgxIiwic3ViIjoie1wiaWRcIjoxNjgxMTA3NjgwMTg0MzQwNDgxLFwibW9iaWxlXCI6XCIrODYxNzM0NTA0MzM2NVwifSIsImV4cCI6MTcwNjMzODIwMH0.w-BB1Zay0mzfo9rig2Qx1mdipEGvdhOXeNSHSbi02EceeWcXkxQv9blYqIu7vu7yPDCm5WWLGhes2m77-fQwPw'
# print(authdev)
anthpre='Bearer eyJhbGciOiJIUzUxMiJ9.eyJqdGkiOiIxNjg2NjM5NTA0NTgwMTkwMjEwIiwic3ViIjoie1wiaWRcIjoxNjg2NjM5NTA0NTgwMTkwMjEwLFwibW9iaWxlXCI6XCIrODYxODM4NDI1MzUwNlwifSIsImV4cCI6MTcwNjUxMzE2OX0.c8ch4WBbE6raEe8PKSkMcf5-GcO-TNis81sAcrE6RveVntoxUtVB076l8lhfA1IqshgF1u7msB9Q9uUlmIVhRw'
def getvideoinfo(vid):
    url=basurl+'v1/study-cn/resource-detail'
    header={'Authorization':anthpre}
    data={"resource_list":[{"resource_id":vid,"resource_type":1}],"uid":1640976882862985217}
    req=requests.post(url=url,headers=header,json=data)
    return req.json()


if __name__ == '__main__':
    # info=getvideoinfo(17052)['data']['video_list'][0]['video_play']['urls']['playUrls']
    # print(info)
    listvideo=[15812,
15814,
15810,
15813,
15811,
15815,
17053,
15821,
15824,
15822,
15826,
15823,
15825,
3102,
15837,
15836,
15832,
15833,
15834,
3203,
15847,
15848,
15843,
15844,
15845,
15846,
18096,
15858,
15857,
15855,
15854,
15864,
14839,
15870,
15871,
15875,
15874,
15872,
15873,
292,
15881,
15880,
15877,
15876,
15879,
15793,
15892,
15891,
15888,
15887,
15889,
15890,
18103,
15895,
15896,
15044,
15893,
15894,
15897,
17150,
15904,
15903,
15900,
15899,
15901,
15902,
11817,
15909,
15910,
15905,
15906,
15907,
279,
15915,
15916,
15911,
15912,
15913,
15914,
18111,
15921,
15922,
15917,
15918,
15920,
17213,
15952,
15951,
15947,
15948,
15949,
15950,
9486,
15957,
15958,
15954,
15953,
15956,
14883,
15964,
15963,
15959,
15960,
15962,
17151,
15970,
15969,
15966,
15965,
15968,
9971,
15975,
15976,
15971,
15972,
15973,
14885,
15981,
15982,
15978,
15977,
15980,
146,
15988,
15987,
15983,
15984,
15985,
15986,
17422,
15993,
15994,
15989,
15990,
15992,
17088,
16000,
15999,
15996,
15995,
15997,
15998,
133,
16005,
16006,
16002,
16001,
16004,
17137,
16011,
16012,
16008,
16007,
16009,
16010,
10100,
16017,
16018,
16014,
16013,
16016,
9349,
16045,
16044,
16046,
154,
16049,
16048,
16050,
10431,
16054,
16053,
16051,
9600,
16055,
16057,
16056,
9606,
16061,
16060,
16059,
150,
16063,
16065,
16064,
276,
16067,
16068,
16069,
10519,
16072,
16071,
16074,
10388,
16075,
16076,
16077,
15781,
16080,
16081,
16079,
10074,
16083,
16085,
16084,
17175,
16089,
16087,
16090,
17296,
16091,
16094,
16092,
10386,
16111,
18717,
16113,
16112,
16114,
10469,
16115,
16118,
16117,
15643,
16119,
16122,
16120,
16121,
17345,
16123,
16125,
9939,
16127,
16130,
16128,
16129,
81,
16131,
16134,
16132,
9430,
16135,
16138,
16137,
16136,
73,
16139,
16142,
16140,
11758,
16143,
16146,
16145,
16144,
10436,
16147,
16150,
16149,
78,
16151,
16154,
16152,
16153,
10479,
16155,
16158,
16157,
10340,
11707,
16178,
16177,
8279,
16176,
8470,
8281,
8280,
8282,
8283,
16182,
16180,
8472,
8285,
8286,
8287,
8284,
16186,
16184,
8469,
8288,
8291,
8290,
8289,
16190,
8471,
8292,
8295,
8293,
8294,
16194,
16192,
8385,
8296,
8299,
8297,
8298,
16196,
16198,
1750,
8304,
8307,
8305,
8306,
16200,
16202,
8391,
16203,
8309,
16205,
8311,
16206,
8386,
16207,
8312,
16209,
8313,
16208,
16210,
8505,
16211,
8319,
16213,
8316,
16214,
8506,
16215,
8321,
16217,
8323,
16216,
16218,
8503,
16219,
8329,
16221,
8331,
16222,
8504,
16223,
8332,
16225,
8335,
16224,
16226,
1672,
]
    otherlisttt=[3102, 3203, 292, 15793, 279, 15918, 15920, 17213, 15952, 9486, 146, 133, 9349, 154, 9600, 9606, 150, 276, 15781, 81, 9430, 78, 8279, 8470, 8281, 8280, 8282, 8283, 8472, 8285, 8286, 8287, 8284, 8469, 8288, 8291, 8290, 8289, 8471, 8292, 8295, 8293, 8294, 8385, 8296, 8299, 8297, 8298, 1750, 8304, 8307, 8305, 8306, 8391, 8309, 8311, 8386, 8312, 8313, 8505, 8319, 8316, 8506, 8321, 8323, 8503, 8329, 8331, 8504, 8332, 8335, 1672]

    listplay=['FD','LD','SD','HD','OD','HQ',]
    videoinfolist=[]
    otherlist=[]
    for vid in listvideo:
        info=getvideoinfo(vid)
        sleep(0.2)
        print(info)
        try:
            play_url=info['data']['video_list'][0]['video_play']['urls']['playUrls']
            # print(play_url)
            for i in range(len(play_url)):
                info_play=play_url[i]['definition']
                if info_play != 'HQ':
                    videoinfolist.append([vid,info_play])
                if info_play not in listplay:
                    print('%d视频资源清晰异常，清晰度为：%s' %(vid,info_play))
                if info_play == 'OD':
                    print('检查 OD 原画视频视频id为：%s' % vid)

        except:
            otherlist.append(vid)
            print('其他视频！%s' %vid)
    print(videoinfolist)
    print(otherlist)
    path=r'C:\Users\zhang\Desktop\pandaInterfaceTest\result\responsetime.txt'
    with open(path, "w") as file:
        for iii in videoinfolist:
            file.write(str(iii))
            file.write('\n')

        file.close()

